CyRadar Intern Pentest Team

Week 1: Linux and Bash Script

Task 1 : Cài đặt song song HĐH Ubuntu (20.04 LTS) 





Task 2: Tìm hiểu về hệ điều hành Linux

Chức năng, ý nghĩa của các thư mục dưới thư mục gốc ( / ) 
nguồn tham khảo: https://www.linux.com/training-tutorials/linux-filesystem-explained/

tree là một công cụ giúp xem cây thư mục trên Linux. Bắt đầu cài tree :    sudo apt-get install tree
lệnh tree / : dấu / trong câu lệnh này thể hiện cho thư mục gốc.  Thư mục gốc là thư mục mà tất cả các thư mục khác đều rẽ nhánh từ nó ra. Khi chạy câu lệnh ‘ tree / ‘ , tất cả toàn bộ cây thư mục sẽ được hiển thị bao gồm tất cả các thư mục con của hệ thống và cả các tệp con của các thư mục đó...

	-  Lệnh tree -L 1 / : hiển thị các thư mục ở cấp dưới thư mục gốc:
	 ‘-L’ thể hiện việc muốn xem mấy cập độ bên dưới thư mục gốc
	    	
	-  Các thư mục dưới thư mục gốc: 
/bin :
là thư mục chứa các tệp nhị phân, tức là một số ứng dụng và chương trình bạn có thể chạy.  Sẽ tìm thấy chương trình ls được đề cập ở trên trong thư mục này, cũng như các công cụ cơ bản khác để tạo và xóa tệp và thư mục,...
/boot:
Chứa các tập tin cần thiết để khởi động hệ thống. Nếu làm thay đổi một trong những file ở đây , có thể gặp tình trạng không thể chạy Linux và rất khó để sửa chữa. Nhưng cần phải có đặc quyền của superuser để có thể làm điều đó.\


/dev: device
Chứa các tệp thiết bị cho tất cả các thiết bị phần cứng trên máy như : CPU , cdrom , …
nhiều trong số này được tạo ra tại thời điểm khởi động hoặc thậm chí khi đang hoạt động.
Ví dụ: Nếu cắm thêm 1 thiết bị như webcam hay USB, 1 mục nhập thiết bị mới sẽ được tạo tự động ở đây.

/etc: có thể gọi nó là “ everything to configure “
nó chứa gần hết các file cấu hình hệ thống. Ví dụ: các tệp chứa tên hệ thống của bạn, người dùng và mật khẩu của họ, tên của các máy trong mạng của bạn cũng như thời điểm và vị trí các phân vùng trên đĩa cứng


home
Nơi sẽ tìm thấy các thư mục cá nhân của người dùng.

lib : libraries
nó chứa các mô-đun hạt nhân quan trọng. Các mô-đun nhân là trình điều khiển làm cho những thứ như card màn hình, card âm thanh, WiFi, máy in, v.v. của bạn hoạt động.

/media
là nơi bộ nhớ ngoài sẽ tự động được gắn vào khi bạn cắm nó vào và cố gắng truy cập nó.
/mnt
Đây là nơi có thể gắn các thiết bị lưu trữ hoặc phân vùng theo cách thủ công. Nó không được sử dụng thường xuyên ngày nay.
/opt : option
Chứa các phần mềm, ứng dụng được cài từ bên thứ 3

/proc
là một thư mục ảo giống như /dev. Nó chứa thông tin về máy tính của bạn, chẳng hạn như thông tin về CPU và hạt nhân mà hệ thống Linux của bạn đang chạy. Như với / dev, các tệp và thư mục được tạo khi máy tính của bạn khởi động, khi hệ thống của bạn đang chạy và mọi thứ thay đổi.

/root
là thư mục chính của superuser (còn được gọi là "Administrator") của hệ thống. Nó tách biệt với phần còn lại của thư mục chính của người dùng
Note : không được nhầm với ‘ / ‘
/run
Các tiến trình hệ thống sử dụng nó để lưu dữ liệu tạm thời.

/sbin
tương tự /bin, nhưng nó chứa các ứng dụng mà chỉ đặc quyền superuser cần. Có thể sử dụng các ứng dụng này với lệnh sudo giúp tạm thời thừa nhận bạn quyền của superuser.
/sbin thường chứa các công cụ có thể cài đặt nội dung, xóa nội dung và định dạng nội dung, nên khá nguy hiểm nếu sử dụng chúng không đúng cách, vì vậy cần xử lý cẩn thận.

/usr
chứa các ứng dụng, thư viện, tài liệu, hình nền, biểu tượng và một danh sách dài các thứ khác cần được chia sẻ bởi các ứng dụng và dịch vụ.
Cũng có thể tìm thấy các thư mục như: bin, sbin và lib trong /usr.

/srv : service / server
Chứa các tệp liên quan đến máy chủ và dịch vụ cụ thể hay là dữ liệu cho server. 
Nếu bạn đang chạy một máy chủ FTP, các tệp của bạn sẽ đi vào / srv / ftp.
Nếu bạn đang chạy một máy chủ web từ  Linux của mình, các tệp HTML cho các trang web của bạn sẽ đi vào 
/srv /http (hoặc /srv /www).
/sys
là một thư mục ảo khác như / proc và / dev và cũng chứa thông tin từ các thiết bị được kết nối với máy tính của bạn.
Cho phép lưu trữ và sửa đổi các thiết bị được kết nối với hệ thống.

/tmp
Chứa các file tạm thời, thường được tạo ra bởi cá ứng dụng đang chạy. Các file và thư mục này thường ( không phải luôn luôn) chứa dữ liệu mà các ứng dụng có thể chưa cần dùng ngay mà có để dùng sau đó.
/tmp là một trong những thư mục dưới ‘/’ mà cho phép sử dụng bới người không phải superuser.

/var
/ var chứa những thứ như nhật ký trong thư mục con /var/log. Nhật ký là tệp ghi lại các sự kiện xảy ra trên hệ thống. Nếu ai đó cố gắng đột nhập vào máy tính của bạn từ bên ngoài, tường lửa của bạn cũng sẽ ghi lại hành động đó tại đây.
Nó cũng chứa spools cho những nhiệm vụ khác .



Phân cấp tiêu chuẩn cho hệ thống file:



Tìm hiểu các hệ thống file có trên Linux



2.1. Hệ thống tệp Ext, Ext2, Ext3 và Ext4
Hệ thống tập tin Ext là viết tắt của Extended File System . Nó chủ yếu được phát triển cho MINIX OS . Hệ thống tệp Ext là phiên bản cũ hơn và không còn được sử dụng do một số hạn chế.
Ext2 là hệ thống tệp Linux đầu tiên cho phép quản lý hai terabyte dữ liệu. Ext3 được phát triển thông qua Ext2; nó là phiên bản nâng cấp của Ext2 và có khả năng tương thích ngược. Hạn chế lớn của Ext3 là không hỗ trợ máy chủ vì hệ thống tệp này không hỗ trợ khôi phục tệp và ảnh chụp nhanh đĩa.
Hệ thống tệp Ext4 là hệ thống tệp nhanh hơn trong số tất cả các hệ thống tệp Ext. Đây là một tùy chọn rất tương thích cho các đĩa SSD (ổ thể rắn) và nó là hệ thống tệp mặc định trong bản phân phối Linux.
2.2. Hệ thống tệp JFS
JFS là viết tắt của Journaled File System , và nó được IBM phát triển cho AIX Unix . Nó là một thay thế cho hệ thống tệp Ext. Nó cũng có thể được sử dụng thay cho Ext4, nơi cần sự ổn định với ít tài nguyên. Nó là một hệ thống tệp tiện dụng khi sức mạnh của CPU bị hạn chế. 
2.3. Hệ thống tệp ReiserFS
ReiserFS là một giải pháp thay thế cho hệ thống tệp Ext3. Nó đã được cải thiện hiệu suất và các tính năng nâng cao. Trong thời gian trước đó, ReiserFS được sử dụng làm hệ thống tệp mặc định trong SUSE Linux, nhưng sau đó nó đã thay đổi một số chính sách nên SUSE quay trở lại Ext3. Hệ thống tệp này hỗ trợ động phần mở rộng tệp, nhưng nó có một số hạn chế về hiệu suất.
2.4. Hệ thống tệp XFS
Hệ thống tệp XFS được coi là JFS tốc độ cao, được phát triển để xử lý I / O song song. NASA vẫn đang sử dụng hệ thống tệp này với máy chủ lưu trữ cao (máy chủ 300+ Terabyte).
2.5. Hệ thống tệp Btrfs
Btrfs là viết tắt của hệ thống tệp B cây . Nó được sử dụng để chịu lỗi, sửa chữa hệ thống, quản trị vui vẻ, cấu hình lưu trữ mở rộng và hơn thế nữa. Nó không phải là một phù hợp tốt cho hệ thống sản xuất.
2.6. Hoán đổi hệ thống tệp
Hệ thống tệp hoán đổi được sử dụng để phân trang bộ nhớ trong hệ điều hành Linux trong chế độ ngủ đông của hệ thống. Một hệ thống không bao giờ ở trạng thái ngủ đông bắt buộc phải có không gian hoán đổi bằng với kích thước RAM của nó .
Cách kiểm tra loại file hệ thống trên Linux.
3.1. dùng lệnh     lsblk -f :

3.2. dùng file
	Câu lệnh : sudo file -sL /dev/sda1    : cung cấp loại hệ thống  tệp đĩa



3.3 dùng fsck
	Câu lệnh: fsck -N /dev/sda1
	thường được sử dụng để sửa hệ thống file, nhưng cũng cho phép kiểm tra loại hệ thống file :




3.4.  cat /etc/fstab
dùng lệnh cat để đọc nội dung trong file này.


3.5. dùng df:
lệnh :    df -Th
Lệnh df với tùy chọn –Th cung cấp một cái nhìn rất chi tiết về dữ liệu loại tệp cùng với mức sử dụng phần trăm và chi tiết điểm gắn kết.



Task 3: Tìm hiểu cách cài đặt phần mềm:
Chạy file .deb
Tải file .deb về máy
mở Terminal : ctrl  + alt + T
chạy lệnh : cd ~
                  cd Downloads/ : mở thư mục Downloads
		ls : Hiển thị các file trong thư mục Downloads
		sudo apt install ./<filename> : tiến hành install 


Đây là ví dụ cài trình duyệt Chrome, nhập xong password là bắt đầu cài.
(Em đã cài rồi nên em chỉ làm đến bước này )

Cài qua apt-get
Lệnh apt ( Advanced Package Tool) : được dùng để quản lí các dpkg package (Phần mềm/ ứng dụng trên hệ thống của Ubuntu.
apt-get dùng để cài đặt , nâng cấp và dọn dẹp các package.
apt-get cơ bản làm việc trên csdl của các gói có sẵn . Nếu không cập nhật csdl này, hệ thống sẽ không biết nếu có những cái package mới hay là không. Trong thực tế, đây là câu lệnh đầu tiên cần chạy sau khi cài Linux mới. 

sudo apt-get update 
sử dụng sudo vì khi update csdl gói yêu cầu đặc quyền của người dùng siêu cấp ( superuser privileges)

Hit : Không có sự thay đổi trong phiên bản package
get : Có một phiên bản mới có sẵn của gói. apt-get sẽ tải xuống thông tin này( không phải chính gói đấy).
Nâng cấp những gói đã cài đặt :     sudo apt-get upgrade

Sự khác nhau giữa update và upgrade: 
sudo apt-get update: sẽ cập nhật xem có phiên bản nào mới nhất đang có sẵn.
sudo apt-get upgrade: sẽ nâng cấp các gói đã cài đặt lên phiên bản mới hơn.

Làm thế nào để cài 1 gói mới với  apt-get ?
Nếu biết tên gói : 
sudo apt-get install <package_name>
ví dụ: cài gói pinta:

Nếu không chắc chắn về tên gói, có thể gõ một phần đầu của tên gói rồi ấn tab:






Task 4: Tìm hiểu lệnh trên Terminal

https://www.cyberciti.biz/faq/how-to-check-os-version-in-linux-command-line/

Xem thông tin OS
mở terminal: ctrl + alt + T
gõ câu lệnh : cat /etc/os-release

		-  lệnh uname -a:


Xem cấu hình máy

sudo lscpu 

	-  xem trực tiếp trên máy: setting -> About :


Xem thông tin về mạng
Sử dụng ifconfig :

Sử dụng ip link show:

Quản lý tiến trình
dùng lệnh top:

Lệnh top dùng để kiểm tra việc sử dụng tài nguyên hệ thống và các tiến trình đang chiếm nhiều tài nguyên hệ thống nhất. top sẽ hiển thị ra danh sách các tiến trình theo thứ tự giảm dần các của mức độ sử dụng CPU.

để thoát ấn Ctrl + C. Phím tắt này sẽ kết thúc tiến trình đang chạy trong terminal.

dùng lệnh htop: 
Đây là một cải tiến của top. Nó chưa được cài sẵn nên muốn dùng cần cài. Câu lệnh cài:  sudo apt-get install htop
Sau khi cài xong, chạy lệnh htop :


Tìm kiếm file
dùng lệnh find:
find -name *.txt  : tìm kiếm các file .txt

thử tìm kiếm theo tên chính xác : 
find -name testfile1.txt

thử tìm tất cả các file .txt trong Desktop:
find /home/nqh/Desktop -name *.txt


Đặt lịch chạy định kỳ
Crontab (cron xuất phát từ "chronos", theo tiếng Hy Lạp có nghĩa là thời gian, tab là viết tắt của table), được tạo ra trên Unix và hoặc những hệ điều hành nhân Unix, thường dùng để lập lịch cho các câu lệnh để thực thi định kỳ.
kiểm tra các crontab nào đang chạy trên hệ thống :
sudo crontab -l

Chỉnh sửa crontab :  sudo crontab -e


Nó sẽ mở trình soạn thảo mặc định (có thể là vi hoặc pico, có thể thay đổi trình soạn thảo mặc định nếu bạn muốn) để chúng ta thao tác với crontab. Nếu bạn lưu lại và thoát trình soạn thảo, tất cả cronjobs được lưu lại trong crontab. Cronjobs được viết theo định dạng sau:
* * * * *  /bin/execute/this/script.sh 
các dấu * theo thứ tự thể hiện:
minute - phút ( 0 -59 )
hour - giờ ( 0 - 24 )
day of month - ngày trong tháng ( 0 -31 )
month - tháng ( 1 - 12 )
day of week ( 0 - 6 - Sunday - Saturday )
ví dụ: nếu để toàn dấu * : thực thi mỗi phút 1 lần , không có ngoại lệ.
0 1 * * 1-5    : 1 giờ 0 phút từ thứ 2 đến thứ 6



Từ khóa thay thế các dấu * :
@reboot         Chạy một lần mỗi khi khởi động lại
@yearly          Chạy một lần mỗi năm    "0 0 1 1 *"
@annually     (Tương tự @yearly)
@monthly     Chạy  mỗi tháng một lần  "0 0 1 * *"
@weekly       Chạy mỗi tuần một lần  "0 0 * * 0"
@daily           Chạy một lần mỗi ngày    "0 0 * * *"
@midnight   (Tương tự @daily)
@hourly        Chạy một lần mỗi giờ    "0 * * * *"

ví dụ : @daily /bin/execute/this/script.dh
		

Phân quyền:

Có 2 khái niệm trong phần này là ownership và permissions.
7.1. ownership: chủ sở hữu:
Mỗi file hay thư mục trên Linux đều được gán bởi 3 chủ sở hữu là user, group, và other
User: 
Theo như mặc định trên Linux thì người tạo ra file hay thư mục nào đó thì sẽ trở thành chủ sở hữu của chính nó, giống như việc một người A tạo ra một vậy B thì mặc định người A sẽ là chủ sở hữu của vật B đó.
Group: 
Một nhóm có thể chứa nhiều người dùng cùng một lúc. Tất cả người dùng trong một nhóm sẽ có cùng quyền truy cập vào file hay thư mục đó. Giả sử có một tài liệu học tập cho một lớp học mà bạn không muốn cho lớp khác biết, chỉ muốn chia sẻ trong lớp. Thay vì bạn cấp quyền cho từng người trong lớp thì bạn có thể gom tất những người trong lớp thành một nhóm người dùng và bạn gán quyền cho một nhóm người dùng đó để chỉ có những người trong nhóm đó mới có quyền truy cập vào tài liệu.
Other: 
Other là bất kỳ người dùng nào không thuộc vào 2 đối tượng phía trên. Xét lại ví dụ trên, bạn không phải là thuộc nhóm lớp được truy cập vào tài liệu và bạn cũng không phải là người sở hữu tài liệu đó thì bạn được xét là other.

7.2. permissions : quyền
       được sử dụng để phân biệt và kiểm soát hành vi của người dùng.
	- mỗi file hay thư mục trong linux đều có 3 quyền : đọc , ghi, và thực thi.
Đọc(r): 
	Nếu là một file thì quyền này cho phép bạn mở file đó lên và đọc. Nếu là một thư mục thì nó cho phép bạn liệt kê danh sách file hay thư mục trong thư mục đó.
Ghi(w): 
Quyền ghi cho phép bạn sửa đổi nội dung của file. Nếu là thư mục thì nó cho phép bạn có thể thêm, xóa và đổi tên các file trong thư mục đó.
Thực thi(x - execute): 
Với Windows bạn có thể chạy với một file có đuôi ".exe" một cách dễ dàng. Khác so với Windows, trong Linux bạn không thể chạy khi nó không được cấp quyền thực thi. Còn đối với thư mục thì bạn không thể truy cập(cd) nếu bạn không có quyền thực thi nó.
	Câu lệnh liên quan:
	1. ls -l : liệt kê, xem quyền và chủ sở hữu:
	
drwxr-xr-x :
+ d : thể hiện đây là thư mục, nếu là ‘-’ thì đó là file
+ rwx: các quyền của user
+ r-x : các quyền của group : đọc và thực thi (r-x) , ‘-’ không có quyền
+ r-x : Các quyền của other

2. chmod : viết tắt của ‘change mode’ dùng để thay đổi quyền của một thư mục hay file trên Linux.
câu lệnh:     chmod <permission-number> <filename>



permission-number về cơ bản sẽ có 3 chữ số. 
 + số thứ nhất là quyền của user
 + số thứ 2 là quyền của group
 + số thứ 3 là quyền của other

ví dụ:




Task 5: Tìm hiểu căn bản về cách viết Bash script  
https://www.shellscript.sh/
Hello World


nano t1.sh







Thao tác với biến:



Vòng lặp với ví dụ nhập mật khẩu:




code:


